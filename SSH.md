#Tìm hiểu về SSH##1. Khái niệm - SSH (tiếng Anh: Secure Shell) là 1 giao thức mạng dùng để thiết lập kết nối mạng 1 cách bảo mật.- SSH hoạt động ở lớp trên trong mô hình phân lớp TCP/IP.- Các công cụ SSH (như là OpenSSH, PuTTy,…) cung cấp cho người dùng cách thức để thiết lập kết nối mạng được mã hoá để tạo 1 kênh kết nối riêng tư.- Hơn nữa tính năng tunneling (hoặc còn gọi là port forwarding) của các công cụ này cho phép chuyển tải các giao vận theo các giao thức khác.- Mỗi khi dữ liệu được gửi bởi 1 máy tính vào mạng, SSH tự động mã hoá nó. Khi dữ liệu được nhận vào, SSH tự động giải mã nó.- Kết quả là việc mã hoá được thực hiện trong suốt.**Ưu điểm**: SSH là một chương trình tương tác giữa máy chủ và máy khách có sử dụng cơ chế mã hoá đủ mạnh nhằm ngăn chặn các hiện tượng nghe trộm, đánh cắp thông tin trên đường truyền. Các chương trình trước đây: telnet, rlogin không sử dụng phương pháp mã hoá. Vì thế bất cứ ai cũng có thể nghe trộm thậm chí đọc được toàn bộ nội dung của phiên làm việc bằng cách sử dụng một số công cụ đơn giản. Sử dụng SSH là biện pháp hữu hiệu bảo mật dữ liệu trên đường truyền từ hệ thống này đến hệ thống khác.##Các đặc điểm chính của giao thức ssh- Tính bảo mật (Privacy): mã hoá dữ liệu dựa trên khoá ngẫu nhiên. (AES, DES, 3DES, ARCFOUR ...)- Tính toàn vẹn (integrity): đảm bảo thông tin không bị biến đổi bằng phương pháp kiểm tra toàn vẹn mật mã (MD5 và SHA-1.).- Chứng minh xác thực (authentication): kiểm tra định danh của ai đó để xác định đúng là người đó hay không- Giấy phép (authorization) :dùng để điều khiển truy cập đến tài khoản.Quyết định ai đó có thể hoặc không thể làm gì.- Chuyển tiếp (forwarding) hoặc tạo đường hầm (tunneling) để mã hoá những phiên khác dựa trên giao thức TCP/IP. SSH hỗ trợ 3 kiểu chuyển tiếp : -  TCP port forwarding: SSH dùng TCP/IP làm cơ chế truyền, thường dùng port 22 trên máy server khi nó mã hoá và giải mã lưu lượng đi trên mạng. Ở đây chúng ta nói đến một đặc điểm mã hoá và giải mã lưu lựong TCP/IP thuộc về ứng dụng khác, trên cổng TCP khác dùng SSH. Tiến trình này gọi là port forwarding, nó có tính trong suốt cao va khá mạnh. Telnet, SMTP, NNTP, IMAP và những giao thức không an toàn khác chạy TCP có thể được bảo đảm bằng việc chuyển tiếp kết nối thông qua SSH. Port forwarding đôi khi được gọi là tunneling bởi vì kết nối SSH cung cấp một “đường hầm” xuyên qua để kết nối TCP khác có thể đi qua. Giả sử bạn có một máy H ở nhà đang chạy IMAP và bạn muốn kết nối đến một IMAP server trên máy S để đọc và gửi mail. Bình thường thì việc kết nối này không đảm bảo an toàn, tài khoản và mật khẩu mail của bạn được truyền đi dưới dạng clear text giữa chương trình mail của bạn và server. Đối với SSH port forwarding, bạn có thể định tuyến lại trong suốt kết nối IMAP ( tìm cổng TCP 143 trên server S) để truyền đi thông qua SSH, mã hoá bảo đảm dữ liệu truyền đi trên kết nối. Máy IMAP server phải chạy một SSH server cho port forwarding để cung cấp việc bảo đảm đó. Tuy nhiên, SSH port forwarding chỉ hoạt động trên giao thức TCP và không làm việc được trên các giao thức khác như UDP hay AppleTalk -  X forwarding : X là một hệ thống window phổ biến đối với các trạm làm việc Unix, một trong những đặc điểm tốt nhất của nó là tính trong suốt. Sử dụng X bạn có thể chạy ứng dụng X từ xa để mở các cửa sổ của chúng trên màn hình hiển thị cục bộ của bạn -  Agent forwarding : SSH client có thể làm việc với một SSH agent trên cùng một máy. Sử dụng một đặc trưng gọi là agent forwarding, client cũng có thể liên lạc với các agent trên những máy từ xa. Điều thuận lợi là nó cho phép client trên nhiều máy làm việc với một agent và có thể tránh vấn đề liên quan đến tường lửa.##keyKey : Một lượng dữ liệu tương đối nhỏ, thông thường từ mười đến một hoặc hai ngàn bit. Tính hữu ích của việc sử dụng thuật toán ràng buộc khoá hoạt động trong vài cách để giữ khoá: trong mã hoá, nó chắc chắn rằng chỉ người nào đó giữ khoá (hoặc một ai có liên quan) có thể giải mã thông điệp, trong xác thực, nó cho phép bạn kiểm tra trễ rằng người giữ khoá thực sự đã kí hiệu vào thông điệp. Có hai loại khóa: khoá đối xứng hoặc khoá bí mật và khoá bất đối xứng hoặc khóa công khai. Một khoá bất đối xứng hoặc khoá công khai có hai phần: thành phần công khai và thàn phần bí mật.Khi tạo ra một SSH Key, bạn cần biết sẽ có 3 thành phần quan trọng như sau:- Public Key (dạng file và string) – Bạn sẽ copy ký tự key này sẽ bỏ vào file ~/.ssh/authorized_keys trên server của bạn.- Private Key (dạng file và string) – Bạn sẽ lưu file này vào máy tính, sau đó sẽ thiết lập cho PuTTY, WinSCP, MobaXterm,..để có thể login.- Keypharse (dạng string, cần ghi nhớ) – Mật khẩu để mở private key, khi đăng nhập vào server nó sẽ hỏi cái này.#SSH truy nhập từ xa để quản trị máy chủ- Cài đặt SSH: sử dụng lệnh ``sudo apt-get install openssh-server``- Khởi động SSHsử dụng lệnh ``sudo /etc/init.d/ssh start``- Cấu hình SSH trong file hệ thống sshd.conf```sudo vi /etc/ssh/sshd_config``<img src="http://i.imgur.com/ga3Djrh.png">Trong đó:ListenAddress 0.0.0.0 : Chỉ cho phép đăng nhập SSH từ một IP cố định.RSAAuthentication yes : xác thực bằng thuật toán rsaPubkeyAuthentication yes : xác thực khóa công khaiAuthorizedKeysFile  %h/.ssh/authorized_keys : đường dẫn file authorized key (file chứa public-key)Port 22 : cổng mặc định của SSH ServerPermitRootLogin no : cho phép user root đăng nhập qua kết nối SSHPasswordAuthentication yes : cho phép đăng nhập bằng password.- Sau đó lưu thay đổi lại ``` sudo /etc/init.d/ssh restart ```##CÁCH TẠO KẾT NỐI QUẢN TRỊ SERVER TỪ XAChúng ta sẽ dùng SSH Client tạo kết nối đến SSH Server để làm việc với máy chủ.trong máy Ubuntu client gõ lệnh ```ssh <host name server>@<địa chỉ IP server>```server sẽ yêu cầu cung cấp mật khẩu. Sau khi nhập mật khẩu ta sẽ điều khiển máy server<img src="http://i.imgur.com/I8UqCt1.png">